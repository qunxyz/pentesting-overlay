# Copyright 1999-2017 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Id$

EAPI=6
PYTHON_COMPAT=( python2_7 )

inherit libtool python-single-r1

DESCRIPTION="Google's C++ mocking framework patched for the Unity desktop"
HOMEPAGE="http://code.google.com/p/googlemock/"
SRC_URI="https://github.com/google/googlemock/archive/release-${PV}.tar.gz"

LICENSE="BSD"
SLOT="0"
KEYWORDS="amd64 x86"
IUSE=""

RDEPEND="=dev-cpp/gtest-${PV}*"
DEPEND="${RDEPEND}
	app-arch/unzip
	${PYTHON_DEPS}"

S="${WORKDIR}/googlemock-release-${PV}"

#src_unpack() {
#	default
	# make sure we always use the system one
	#rm -r "${S}"/gtest/{Makefile,configure}* || die
#}

src_prepare() {
	#sed -i -r \
	#	-e '/^install-(data|exec)-local:/s|^.*$|&\ndisabled-&|' \
	#		Makefile.in
	eapply_user

	#eautoreconf
	elibtoolize
}

src_install() {
	default
	#dobin scripts/gmock-config
	#use static-libs || find "${D}" -name '*.la' -delete

	insinto /usr/src/gmock/
	doins -r *

	#insinto /usr/src/gmock
	#doins -r gtest CMakeLists.txt
}
