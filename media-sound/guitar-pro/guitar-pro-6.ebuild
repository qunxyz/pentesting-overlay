# Copyright 1999-2014 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Id$

EAPI=6

inherit eutils gnome2-utils xdg-utils

DESCRIPTION="A popular tablature editor software for guitar, bass, and many other instruments."
HOMEPAGE="http://www.guitar-pro.com"
SRC_URI="https://guitar-pro.com/download.php?idfile=gp6_linux -> gp6-full-linux.deb"

LICENSE="GPL-2"
SLOT="1"
KEYWORDS="~amd64 ~ppc ~x86 ~amd64-linux ~x86-linux ~ppc-macos ~x86-macos"
IUSE=""

RDEPEND="dev-libs/openssl:0.9.8"

src_unpack() {
	#ar vx gp6-full-linux.deb
	unpack ${A}
	#cd "${S}"
	tar vzxf data.tar.gz
}

S="${WORKDIR}"

src_install() {
	insinto "/opt"
	doins -r opt/*

	doicon -s scalable "${FILESDIR}"/GuitarPro.png
	newicon -s scalable -c mimetypes "${FILESDIR}"/audio-x-gtp.png audio-x-gtp.png
	newicon -s scalable -c mimetypes "${FILESDIR}"/audio-x-gpbank.png audio-x-gpbank.png

	# install mimetype for Guitar Pro files
	insinto /usr/share/mime/audio
 	newins "${FILESDIR}"/guitar-pro.xml guitar-pro.xml

	insinto /usr/share/applications
	doins "${FILESDIR}"/Guitar-Pro.desktop
}

pkg_post() {
	gnome2_icon_cache_update
	xdg_mimeinfo_database_update
	xdg_desktop_database_update
}
