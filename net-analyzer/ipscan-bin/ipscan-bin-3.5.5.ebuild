# Copyright 1999-2011 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2

EAPI=5

inherit versionator java-pkg-2

DESCRIPTION="Angry IP - The fast and friendly network scanner"
HOMEPAGE="http://www.angryip.org"
S=${WORKDIR}

SRC_URI="amd64? ( https://github.com/angryip/ipscan/releases/download/${PV}/ipscan-linux64-${PV}.jar )
	x86? ( https://github.com/angryip/ipscan/releases/download/${PV}/ipscan-linux-${PV}.jar )"	

LICENSE="GPL-2"
SLOT="0"
KEYWORDS="~amd64 ~x86"
IUSE=""

COMMON_DEPEND=""
DEPEND="${COMMON_DEPEND}"
RDEPEND="${COMMON_DEPEND}
	>=virtual/jre-1.6.0"

src_install() {
	java-pkg_newjar \
		"${DISTDIR}/ipscan-$(my_get_target)-${PV}.jar" \
		ipscan-linux.jar
	java-pkg_dolauncher
	insinto /usr/share/pixmaps
	newins "${FILESDIR}"/ipscan.png ipscan.png || \
		die "cannot copy icon file"
	# make_desktop_entry ipscan "Angry IP Scanner" ipscan 'Application;Network;'
	insinto /usr/share/applications
	doins "${FILESDIR}"/ipscan.desktop || die "cannot copy .desktop file"
}

my_get_target() {
	if use x86; then
		echo linux
	elif use amd64; then
		echo linux64
	else
		die "arch unsupported"
	fi
}
