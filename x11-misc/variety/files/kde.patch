diff -uNr variety-0.7.1-ori/data/scripts/set_wallpaper variety-0.7.1/data/scripts/set_wallpaper
--- variety-0.7.1-ori/data/scripts/set_wallpaper	2018-12-24 17:38:56.842310924 +0800
+++ variety-0.7.1/data/scripts/set_wallpaper	2018-12-30 15:12:20.077046446 +0800
@@ -117,7 +117,7 @@
 # Afterwards, with the command below, Variety will just overwrite the single file there when changing the wallpaper
 # and KDE will refresh it
 # On Plasma 5.7 and above, the wallpaper choosing is automatic.
-if [ "${KDE_FULL_SESSION}" == "true" ]; then
+if [ "${DESKTOP_SESSION}" == "kde" or "${DESKTOP_SESSION}" == "plasma" ]; then
     # Plasma 5.7 introduced a new feature to set the wallpaper via a qdbus script:
     # https://github.com/KDE/plasma-workspace/commit/903cbfd7e267a4812a6ec222eb7e1b5dd775686f
     if [[ -n "${KDE_SESSION_VERSION}" && "${KDE_SESSION_VERSION}" == '5' ]]; then
