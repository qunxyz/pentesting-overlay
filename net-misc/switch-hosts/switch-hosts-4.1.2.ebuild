# Copyright 1999-2016 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Id$

EAPI=6

PYTHON_COMPAT=( python3_{6..10} )

inherit eutils unpacker versionator python-any-r1

DESCRIPTION="Switch hosts quickly!"
HOMEPAGE="https://oldj.github.io/SwitchHosts/"
SRC_URI="https://github.com/oldj/SwitchHosts/releases/download/v${PV}/SwitchHosts._linux_amd64_${PV}.6086.deb -> ${P}.deb"

LICENSE="MIT"
SLOT="0"
KEYWORDS="~amd64"
IUSE=""
RESTRICT="mirror strip"

DEPEND="${PYTHON_DEPS}"
RDEPEND="gnome-base/gconf
    x11-libs/gtk+:2
    virtual/udev
    dev-libs/libgcrypt
    x11-libs/libnotify
    x11-libs/libXtst
    dev-libs/nss
    gnome-base/gvfs
    x11-misc/xdg-utils
    net-print/cups
"

S="${WORKDIR}"

src_unpack() {
    ar x ${DISTDIR}/${A}
    unpack ${WORKDIR}/data.tar.xz
}

src_install() {
    doins -r opt
    doins -r usr
    fperms +x /opt/SwitchHosts/switchhosts
}

pkg_postinst() {
    gnome2_icon_cache_update
    xdg_desktop_database_update
}

pkg_postrm() {
    gnome2_icon_cache_update
    xdg_desktop_database_update
}
