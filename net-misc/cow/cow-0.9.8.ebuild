# Copyright 1999-2013 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Header: app-pda/libplist/libplist-9999.ebuild,v 1.0 2014/01/13 17:21:55 srcs Exp $

EAPI=6
inherit golang-build

DESCRIPTION="HTTP proxy written in Go. COW can automatically identify blocked sites and use parent proxies to access."
HOMEPAGE="https://github.com/cyfdecyf/cow"
SRC_URI="https://github.com/cyfdecyf/cow/archive/${PV}.tar.gz"

LICENSE="GPL-2 LGPL-2.1"
SLOT="0"
KEYWORDS="amd64 ~arm ~ppc ~ppc64 x86"
IUSE=""
DEPEND="dev-lang/go"

GOLANG_PKG_DEPENDENCIES=(
    "github.com/cyfdecyf/bufio"
    "github.com/cyfdecyf/color"
    "github.com/cyfdecyf/leakybuf"
    "github.com/shadowsocks/shadowsocks-go/shadowsocks"
)

src_compile() {
	for pkg in ${GOLANG_PKG_DEPENDENCIES[*]}; do
		echo "##########${pkg}##########"
		GOPATH=${WORKDIR} go get "${pkg}"
	done
	echo "##########${pkg}##########"
    GOPATH=${WORKDIR} go build
}

src_install() {
	dobin ${P} 
	dosym ${P} cow
}