# Copyright 1999-2011 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Header: $

EAPI=6

inherit versionator java-pkg-2 java-ant-2 autotools

DESCRIPTION="IDE for Nmap Script Developers"
HOMEPAGE="https://halcyon-ide.org/"
SRC_URI="https://github.com/s4n7h0/Halcyon/archive/v${PV}.tar.gz -> ${P}.tar.gz"

LICENSE="GPL-2"
SLOT="0"
KEYWORDS="amd64 x86"
IUSE=""

COMMON_DEPEND=""
DEPEND="${COMMON_DEPEND}
	>=virtual/jdk-1.6.0
	>=dev-java/ant-core-1.8"
RDEPEND="${COMMON_DEPEND}
	>=virtual/jre-1.6.0"

PATCHES=(
	"${FILESDIR}/boolean.patch"
)

S="${WORKDIR}/Halcyon-IDE-${PV}"

JAVA_PKG_BSFIX=no

src_prepare() {
	default
}

src_compile() {
	eant || die "ant failed"
}

src_install() {
	insinto /usr/share/pixmaps
	newins "${S}"/src/halcyon/icons/halcyon-logo.png halcyon-ide.png || \
		die "cannot copy icon file"
	make_desktop_entry "java -cp /opt/halcyon-ide/src/lib/autocomplete.jar:/opt/halcyon-ide/src/lib/rsyntaxtextarea.jar:/opt/halcyon-ide/dist/Halcyon_IDE_v${PV}.jar halcyon.ide.HalcyonIDE" "IDE for Nmap Script Developers" halcyon-ide 'Application;Network;'

	insinto /opt/halcyon-ide
	doins -r ./*
}
