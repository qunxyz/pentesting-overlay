# Copyright 1999-2018 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2

EAPI=5

inherit gnome2-utils eutils

DESCRIPTION="A simple, beautiful podcast app for Windows, macOS, and Linux."
HOMEPAGE="https://github.com/z-------------/CPod"
SRC_URI="https://github.com/z-------------/CPod/archive/v${PV}.tar.gz -> ${P}.tar.gz"
RESTRICT="network-sandbox"

LICENSE="LGPL-3"
SLOT="0"
KEYWORDS="amd64 x86"
IUSE=""

RDEPEND="
    sys-apps/yarn
	net-libs/nodejs"
DEPEND="${RDEPEND}"
S="${WORKDIR}/CPod-${PV}"

src_compile() {
	yarn
	gulp
	yarn dist
}

src_install() {
    newicon build/icon.png cpod.png
    insinto /opt/cpod
    cp -R ${S}/dist/linux-unpacked/* ${D}/opt/cpod || die "please reinstall package"
    dosym /opt/cpod/cpod /usr/bin/cpod
    make_desktop_entry cpod "A simple, beautiful podcast app for Windows, macOS, and Linux." cpod
}
