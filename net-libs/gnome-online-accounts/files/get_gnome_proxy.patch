diff -uNr gnome-online-accounts-3.22.5-ori/configure gnome-online-accounts-3.22.5/configure
--- gnome-online-accounts-3.22.5-ori/configure	2017-03-11 01:38:36.000000000 +0800
+++ gnome-online-accounts-3.22.5/configure	2017-09-19 12:46:27.359762237 +0800
@@ -705,8 +705,8 @@
 REST_CFLAGS
 JSON_GLIB_LIBS
 JSON_GLIB_CFLAGS
-LIBSOUP_LIBS
-LIBSOUP_CFLAGS
+LIBSOUP_GNOME_LIBS
+LIBSOUP_GNOME_CFLAGS
 WEBKIT_GTK_LIBS
 WEBKIT_GTK_CFLAGS
 GTK_LIBS
@@ -958,8 +958,8 @@
 GTK_LIBS
 WEBKIT_GTK_CFLAGS
 WEBKIT_GTK_LIBS
-LIBSOUP_CFLAGS
-LIBSOUP_LIBS
+LIBSOUP_GNOME_CFLAGS
+LIBSOUP_GNOME_LIBS
 JSON_GLIB_CFLAGS
 JSON_GLIB_LIBS
 REST_CFLAGS
@@ -1699,10 +1699,10 @@
               C compiler flags for WEBKIT_GTK, overriding pkg-config
   WEBKIT_GTK_LIBS
               linker flags for WEBKIT_GTK, overriding pkg-config
-  LIBSOUP_CFLAGS
-              C compiler flags for LIBSOUP, overriding pkg-config
-  LIBSOUP_LIBS
-              linker flags for LIBSOUP, overriding pkg-config
+  LIBSOUP_GNOME_CFLAGS
+              C compiler flags for LIBSOUP_GNOME, overriding pkg-config
+  LIBSOUP_GNOME_LIBS
+              linker flags for LIBSOUP_GNOME, overriding pkg-config
   JSON_GLIB_CFLAGS
               C compiler flags for JSON_GLIB, overriding pkg-config
   JSON_GLIB_LIBS
@@ -14208,16 +14208,16 @@
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for LIBSOUP" >&5
 $as_echo_n "checking for LIBSOUP... " >&6; }
 
-if test -n "$LIBSOUP_CFLAGS"; then
-    pkg_cv_LIBSOUP_CFLAGS="$LIBSOUP_CFLAGS"
+if test -n "$LIBSOUP_GNOME_CFLAGS"; then
+    pkg_cv_LIBSOUP_GNOME_CFLAGS="$LIBSOUP_GNOME_CFLAGS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"libsoup-2.4 >= 2.42\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "libsoup-2.4 >= 2.42") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"libsoup-gnome-2.4 >= 2.42\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "libsoup-gnome-2.4 >= 2.42") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_LIBSOUP_CFLAGS=`$PKG_CONFIG --cflags "libsoup-2.4 >= 2.42" 2>/dev/null`
+  pkg_cv_LIBSOUP_GNOME_CFLAGS=`$PKG_CONFIG --cflags "libsoup-gnome-2.4 >= 2.42" 2>/dev/null`
 		      test "x$?" != "x0" && pkg_failed=yes
 else
   pkg_failed=yes
@@ -14225,16 +14225,16 @@
  else
     pkg_failed=untried
 fi
-if test -n "$LIBSOUP_LIBS"; then
-    pkg_cv_LIBSOUP_LIBS="$LIBSOUP_LIBS"
+if test -n "$LIBSOUP_GNOME_LIBS"; then
+    pkg_cv_LIBSOUP_GNOME_LIBS="$LIBSOUP_GNOME_LIBS"
  elif test -n "$PKG_CONFIG"; then
     if test -n "$PKG_CONFIG" && \
-    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"libsoup-2.4 >= 2.42\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "libsoup-2.4 >= 2.42") 2>&5
+    { { $as_echo "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"libsoup-gnome-2.4 >= 2.42\""; } >&5
+  ($PKG_CONFIG --exists --print-errors "libsoup-gnome-2.4 >= 2.42") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
-  pkg_cv_LIBSOUP_LIBS=`$PKG_CONFIG --libs "libsoup-2.4 >= 2.42" 2>/dev/null`
+  pkg_cv_LIBSOUP_GNOME_LIBS=`$PKG_CONFIG --libs "libsoup-gnome-2.4 >= 2.42" 2>/dev/null`
 		      test "x$?" != "x0" && pkg_failed=yes
 else
   pkg_failed=yes
@@ -14255,22 +14255,22 @@
         _pkg_short_errors_supported=no
 fi
         if test $_pkg_short_errors_supported = yes; then
-	        LIBSOUP_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "libsoup-2.4 >= 2.42" 2>&1`
+	        LIBSOUP_GNOME_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "libsoup-gnome-2.4 >= 2.42" 2>&1`
         else
-	        LIBSOUP_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "libsoup-2.4 >= 2.42" 2>&1`
+	        LIBSOUP_GNOME_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "libsoup-gnome-2.4 >= 2.42" 2>&1`
         fi
 	# Put the nasty error message in config.log where it belongs
-	echo "$LIBSOUP_PKG_ERRORS" >&5
+	echo "$LIBSOUP_GNOME_PKG_ERRORS" >&5
 
-	as_fn_error $? "Package requirements (libsoup-2.4 >= 2.42) were not met:
+	as_fn_error $? "Package requirements (libsoup-gnome-2.4 >= 2.42) were not met:
 
-$LIBSOUP_PKG_ERRORS
+$LIBSOUP_GNOME_PKG_ERRORS
 
 Consider adjusting the PKG_CONFIG_PATH environment variable if you
 installed software in a non-standard prefix.
 
-Alternatively, you may set the environment variables LIBSOUP_CFLAGS
-and LIBSOUP_LIBS to avoid the need to call pkg-config.
+Alternatively, you may set the environment variables LIBSOUP_GNOME_CFLAGS
+and LIBSOUP_GNOME_LIBS to avoid the need to call pkg-config.
 See the pkg-config man page for more details." "$LINENO" 5
 elif test $pkg_failed = untried; then
      	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
@@ -14281,15 +14281,15 @@
 is in your PATH or set the PKG_CONFIG environment variable to the full
 path to pkg-config.
 
-Alternatively, you may set the environment variables LIBSOUP_CFLAGS
-and LIBSOUP_LIBS to avoid the need to call pkg-config.
+Alternatively, you may set the environment variables LIBSOUP_GNOME_CFLAGS
+and LIBSOUP_GNOME_LIBS to avoid the need to call pkg-config.
 See the pkg-config man page for more details.
 
 To get pkg-config, see <http://pkg-config.freedesktop.org/>.
 See \`config.log' for more details" "$LINENO" 5; }
 else
-	LIBSOUP_CFLAGS=$pkg_cv_LIBSOUP_CFLAGS
-	LIBSOUP_LIBS=$pkg_cv_LIBSOUP_LIBS
+	LIBSOUP_GNOME_CFLAGS=$pkg_cv_LIBSOUP_GNOME_CFLAGS
+	LIBSOUP_GNOME_LIBS=$pkg_cv_LIBSOUP_GNOME_LIBS
         { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
 
diff -uNr gnome-online-accounts-3.22.5-ori/configure.ac gnome-online-accounts-3.22.5/configure.ac
--- gnome-online-accounts-3.22.5-ori/configure.ac	2017-03-11 01:35:48.000000000 +0800
+++ gnome-online-accounts-3.22.5/configure.ac	2017-09-19 12:46:27.335761957 +0800
@@ -122,9 +122,9 @@
   AC_SUBST(WEBKIT_GTK_CFLAGS)
   AC_SUBST(WEBKIT_GTK_LIBS)
 
-  PKG_CHECK_MODULES(LIBSOUP, [libsoup-2.4 >= 2.42])
-  AC_SUBST(LIBSOUP_CFLAGS)
-  AC_SUBST(LIBSOUP_LIBS)
+  PKG_CHECK_MODULES(LIBSOUP_GNOME, [libsoup-gnome-2.4 >= 2.42])
+  AC_SUBST(LIBSOUP_GNOME_CFLAGS)
+  AC_SUBST(LIBSOUP_GNOME_LIBS)
 
   PKG_CHECK_MODULES(JSON_GLIB, [json-glib-1.0])
   AC_SUBST(JSON_GLIB_CFLAGS)
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/16x16/Makefile.in gnome-online-accounts-3.22.5/data/icons/16x16/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/16x16/Makefile.in	2017-03-11 01:38:37.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/16x16/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/22x22/Makefile.in gnome-online-accounts-3.22.5/data/icons/22x22/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/22x22/Makefile.in	2017-03-11 01:38:37.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/22x22/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/24x24/Makefile.in gnome-online-accounts-3.22.5/data/icons/24x24/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/24x24/Makefile.in	2017-03-11 01:38:37.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/24x24/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/256x256/Makefile.in gnome-online-accounts-3.22.5/data/icons/256x256/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/256x256/Makefile.in	2017-03-11 01:38:37.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/256x256/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/32x32/Makefile.in gnome-online-accounts-3.22.5/data/icons/32x32/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/32x32/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/32x32/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/48x48/Makefile.in gnome-online-accounts-3.22.5/data/icons/48x48/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/48x48/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/48x48/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/96x96/Makefile.in gnome-online-accounts-3.22.5/data/icons/96x96/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/96x96/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/96x96/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -246,8 +246,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/icons/Makefile.in gnome-online-accounts-3.22.5/data/icons/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/icons/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/icons/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -276,8 +276,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/data/Makefile.in gnome-online-accounts-3.22.5/data/Makefile.in
--- gnome-online-accounts-3.22.5-ori/data/Makefile.in	2017-03-11 01:38:37.000000000 +0800
+++ gnome-online-accounts-3.22.5/data/Makefile.in	2017-09-19 12:46:27.363762284 +0800
@@ -308,8 +308,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/doc/Makefile.in gnome-online-accounts-3.22.5/doc/Makefile.in
--- gnome-online-accounts-3.22.5-ori/doc/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/doc/Makefile.in	2017-09-19 12:46:27.319761769 +0800
@@ -318,8 +318,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/Makefile.in gnome-online-accounts-3.22.5/Makefile.in
--- gnome-online-accounts-3.22.5-ori/Makefile.in	2017-03-11 01:38:37.000000000 +0800
+++ gnome-online-accounts-3.22.5/Makefile.in	2017-09-19 12:46:27.319761769 +0800
@@ -301,8 +301,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/src/daemon/goadaemon.c gnome-online-accounts-3.22.5/src/daemon/goadaemon.c
--- gnome-online-accounts-3.22.5-ori/src/daemon/goadaemon.c	2017-03-11 01:35:20.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/daemon/goadaemon.c	2017-09-19 12:46:27.255761022 +0800
@@ -24,7 +24,7 @@
 #include <glib/gi18n.h>
 #include <gio/gdesktopappinfo.h>
 #include <rest/rest-proxy.h>
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 
 #include "goadaemon.h"
 #include "goabackend/goabackend.h"
diff -uNr gnome-online-accounts-3.22.5-ori/src/daemon/Makefile.in gnome-online-accounts-3.22.5/src/daemon/Makefile.in
--- gnome-online-accounts-3.22.5-ori/src/daemon/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/daemon/Makefile.in	2017-09-19 12:48:38.053310761 +0800
@@ -277,8 +277,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
@@ -426,6 +426,7 @@
 	$(GLIB_CFLAGS) 						\
 	$(GTK_CFLAGS)						\
 	$(REST_CFLAGS)						\
+	$(LIBSOUP_GNOME_CFLAGS)						\
 	$(NULL)
 
 goa_daemon_LDADD = \
@@ -434,6 +435,7 @@
 	$(top_builddir)/src/goabackend/libgoa-backend-1.0.la	\
 	$(GTK_LIBS)						\
 	$(REST_LIBS)						\
+	$(LIBSOUP_GNOME_LIBS)						\
 	$(NULL)
 
 all: $(BUILT_SOURCES)
diff -uNr gnome-online-accounts-3.22.5-ori/src/examples/Makefile.in gnome-online-accounts-3.22.5/src/examples/Makefile.in
--- gnome-online-accounts-3.22.5-ori/src/examples/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/examples/Makefile.in	2017-09-19 12:46:27.243760883 +0800
@@ -322,8 +322,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/src/goa/Makefile.in gnome-online-accounts-3.22.5/src/goa/Makefile.in
--- gnome-online-accounts-3.22.5-ori/src/goa/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goa/Makefile.in	2017-09-19 12:46:27.227760696 +0800
@@ -315,8 +315,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goaewsclient.c gnome-online-accounts-3.22.5/src/goabackend/goaewsclient.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goaewsclient.c	2017-03-11 01:28:32.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goaewsclient.c	2017-09-19 12:49:41.126072681 +0800
@@ -26,7 +26,7 @@
 
 #include <glib/gi18n-lib.h>
 
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 #include <libxml/xmlIO.h>
 
 #include "goaewsclient.h"
@@ -498,6 +498,7 @@
   data->session = soup_session_new_with_options (SOUP_SESSION_SSL_STRICT, FALSE,
                                                  NULL);
   soup_session_add_feature_by_type (data->session, SOUP_TYPE_AUTH_NTLM);
+  soup_session_add_feature_by_type (data->session, SOUP_TYPE_PROXY_RESOLVER_GNOME);
   data->accept_ssl_errors = accept_ssl_errors;
 
   if (cancellable != NULL)
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goahttpclient.c gnome-online-accounts-3.22.5/src/goabackend/goahttpclient.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goahttpclient.c	2017-03-11 01:28:32.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goahttpclient.c	2017-09-19 12:54:22.233553910 +0800
@@ -18,7 +18,7 @@
 
 #include "config.h"
 
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 
 #include "goahttpclient.h"
 #include "goautils.h"
@@ -232,6 +232,7 @@
   data->session = soup_session_new_with_options (SOUP_SESSION_SSL_STRICT, FALSE,
                                                  NULL);
 
+  soup_session_add_feature_by_type (data->session, SOUP_TYPE_PROXY_RESOLVER_GNOME);
   logger = soup_logger_new (SOUP_LOGGER_LOG_BODY, -1);
   soup_logger_set_printer (logger, http_client_log_printer, NULL, NULL);
   soup_session_add_feature (data->session, SOUP_SESSION_FEATURE (logger));
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goaoauth2provider.c gnome-online-accounts-3.22.5/src/goabackend/goaoauth2provider.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goaoauth2provider.c	2017-03-11 01:35:20.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goaoauth2provider.c	2017-09-19 12:46:27.247760929 +0800
@@ -21,7 +21,7 @@
 #include <stdlib.h>
 
 #include <rest/oauth2-proxy.h>
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 #include <json-glib/json-glib.h>
 #include <webkit2/webkit2.h>
 
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goaoauthprovider.c gnome-online-accounts-3.22.5/src/goabackend/goaoauthprovider.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goaoauthprovider.c	2017-03-11 01:28:32.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goaoauthprovider.c	2017-09-19 12:46:27.251760977 +0800
@@ -21,7 +21,7 @@
 #include <stdlib.h>
 
 #include <rest/oauth-proxy.h>
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 #include <json-glib/json-glib.h>
 #include <webkit2/webkit2.h>
 
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goaowncloudprovider.c gnome-online-accounts-3.22.5/src/goabackend/goaowncloudprovider.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goaowncloudprovider.c	2017-03-11 01:35:20.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goaowncloudprovider.c	2017-09-19 12:46:27.255761022 +0800
@@ -22,7 +22,7 @@
 
 #include <glib/gi18n-lib.h>
 
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 
 #include "goahttpclient.h"
 #include "goaprovider.h"
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goapocketprovider.c gnome-online-accounts-3.22.5/src/goabackend/goapocketprovider.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goapocketprovider.c	2017-03-11 01:35:20.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goapocketprovider.c	2017-09-19 12:46:27.251760977 +0800
@@ -21,7 +21,7 @@
 
 #include <rest/rest-proxy.h>
 #include <json-glib/json-glib.h>
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 
 #include "goaprovider.h"
 #include "goaprovider-priv.h"
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goautils.h gnome-online-accounts-3.22.5/src/goabackend/goautils.h
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goautils.h	2017-03-11 01:35:20.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goautils.h	2017-09-19 12:46:27.251760977 +0800
@@ -26,7 +26,7 @@
 #include <gio/gio.h>
 #include <glib.h>
 #include <gtk/gtk.h>
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 #include <goabackend/goabackendtypes.h>
 
 G_BEGIN_DECLS
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goawebview.c gnome-online-accounts-3.22.5/src/goabackend/goawebview.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goawebview.c	2017-03-11 01:28:33.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goawebview.c	2017-09-19 12:46:27.255761022 +0800
@@ -25,7 +25,7 @@
 #include <glib.h>
 #include <glib/gi18n-lib.h>
 #include <JavaScriptCore/JavaScript.h>
-#include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 #include <webkit2/webkit2.h>
 
 #include "goawebview.h"
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/Makefile.am gnome-online-accounts-3.22.5/src/goabackend/Makefile.am
--- gnome-online-accounts-3.22.5-ori/src/goabackend/Makefile.am	2017-03-11 01:35:20.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/Makefile.am	2017-09-19 12:46:27.255761022 +0800
@@ -124,7 +124,7 @@
 	$(GTK_CFLAGS) 						\
 	$(REST_CFLAGS)						\
 	$(SECRET_CFLAGS)					\
-	$(LIBSOUP_CFLAGS)					\
+	$(LIBSOUP_GNOME_CFLAGS)					\
 	$(LIBXML_CFLAGS)					\
 	$(TP_CFLAGS)						\
 	$(TPAW_CFLAGS)						\
@@ -139,7 +139,7 @@
 	$(GTK_LIBS) 						\
 	$(REST_LIBS)						\
 	$(SECRET_LIBS)						\
-	$(LIBSOUP_LIBS)						\
+	$(LIBSOUP_GNOME_LIBS)						\
 	$(LIBXML_LIBS)						\
 	$(TP_LIBS)						\
 	$(TPAW_LIBS)						\
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/Makefile.in gnome-online-accounts-3.22.5/src/goabackend/Makefile.in
--- gnome-online-accounts-3.22.5-ori/src/goabackend/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/Makefile.in	2017-09-19 12:46:27.251760977 +0800
@@ -407,8 +407,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
@@ -610,7 +610,7 @@
 	$(GTK_CFLAGS) 						\
 	$(REST_CFLAGS)						\
 	$(SECRET_CFLAGS)					\
-	$(LIBSOUP_CFLAGS)					\
+	$(LIBSOUP_GNOME_CFLAGS)					\
 	$(LIBXML_CFLAGS)					\
 	$(TP_CFLAGS)						\
 	$(TPAW_CFLAGS)						\
@@ -625,7 +625,7 @@
 	$(GTK_LIBS) 						\
 	$(REST_LIBS)						\
 	$(SECRET_LIBS)						\
-	$(LIBSOUP_LIBS)						\
+	$(LIBSOUP_GNOME_LIBS)						\
 	$(LIBXML_LIBS)						\
 	$(TP_LIBS)						\
 	$(TPAW_LIBS)						\
diff -uNr gnome-online-accounts-3.22.5-ori/src/goaidentity/Makefile.in gnome-online-accounts-3.22.5/src/goaidentity/Makefile.in
--- gnome-online-accounts-3.22.5-ori/src/goaidentity/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goaidentity/Makefile.in	2017-09-19 12:46:27.243760883 +0800
@@ -310,8 +310,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
diff -uNr gnome-online-accounts-3.22.5-ori/src/Makefile.in gnome-online-accounts-3.22.5/src/Makefile.in
--- gnome-online-accounts-3.22.5-ori/src/Makefile.in	2017-03-11 01:38:38.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/Makefile.in	2017-09-19 12:46:27.227760696 +0800
@@ -277,8 +277,8 @@
 LDFLAGS = @LDFLAGS@
 LIBOBJS = @LIBOBJS@
 LIBS = @LIBS@
-LIBSOUP_CFLAGS = @LIBSOUP_CFLAGS@
-LIBSOUP_LIBS = @LIBSOUP_LIBS@
+LIBSOUP_GNOME_CFLAGS = @LIBSOUP_GNOME_CFLAGS@
+LIBSOUP_GNOME_LIBS = @LIBSOUP_GNOME_LIBS@
 LIBTOOL = @LIBTOOL@
 LIBXML_CFLAGS = @LIBXML_CFLAGS@
 LIBXML_LIBS = @LIBXML_LIBS@
