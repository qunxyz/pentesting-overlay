diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goaewsclient.c gnome-online-accounts-3.22.5/src/goabackend/goaewsclient.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goaewsclient.c	2017-03-11 01:28:32.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goaewsclient.c	2017-09-18 22:01:45.996210752 +0800
@@ -27,6 +27,7 @@
 #include <glib/gi18n-lib.h>
 
 #include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 #include <libxml/xmlIO.h>
 
 #include "goaewsclient.h"
@@ -498,6 +499,7 @@
   data->session = soup_session_new_with_options (SOUP_SESSION_SSL_STRICT, FALSE,
                                                  NULL);
   soup_session_add_feature_by_type (data->session, SOUP_TYPE_AUTH_NTLM);
+  soup_session_add_feature_by_type (data->session, SOUP_TYPE_PROXY_RESOLVER_GNOME);
   data->accept_ssl_errors = accept_ssl_errors;
 
   if (cancellable != NULL)
diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goahttpclient.c gnome-online-accounts-3.22.5/src/goabackend/goahttpclient.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goahttpclient.c	2017-03-11 01:28:32.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goahttpclient.c	2017-09-18 22:02:35.928821177 +0800
@@ -19,6 +19,7 @@
 #include "config.h"
 
 #include <libsoup/soup.h>
+#include <libsoup/soup-gnome.h>
 
 #include "goahttpclient.h"
 #include "goautils.h"
@@ -232,6 +233,7 @@
   data->session = soup_session_new_with_options (SOUP_SESSION_SSL_STRICT, FALSE,
                                                  NULL);
 
+  soup_session_add_feature_by_type (data->session, SOUP_TYPE_PROXY_RESOLVER_GNOME);
   logger = soup_logger_new (SOUP_LOGGER_LOG_BODY, -1);
   soup_logger_set_printer (logger, http_client_log_printer, NULL, NULL);
   soup_session_add_feature (data->session, SOUP_SESSION_FEATURE (logger));
