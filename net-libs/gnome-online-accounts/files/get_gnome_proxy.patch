diff -uNr gnome-online-accounts-3.22.5-ori/src/goabackend/goaewsclient.c gnome-online-accounts-3.22.5/src/goabackend/goaewsclient.c
--- gnome-online-accounts-3.22.5-ori/src/goabackend/goaewsclient.c	2017-03-11 01:28:32.000000000 +0800
+++ gnome-online-accounts-3.22.5/src/goabackend/goaewsclient.c	2017-09-18 20:08:21.738822185 +0800
@@ -495,8 +495,8 @@
   data->msgs[0] = ews_client_create_msg_for_url (url1, buf);
   data->msgs[1] = ews_client_create_msg_for_url (url2, buf);
   data->pending = sizeof (data->msgs) / sizeof (data->msgs[0]);
-  data->session = soup_session_new_with_options (SOUP_SESSION_SSL_STRICT, FALSE,
-                                                 NULL);
+  data->session = soup_session_new_with_options (SOUP_SESSION_SSL_STRICT, SOUP_SESSION_PROXY_RESOLVER,
+                                                 SOUP_SESSION_PROXY_URI);
   soup_session_add_feature_by_type (data->session, SOUP_TYPE_AUTH_NTLM);
   data->accept_ssl_errors = accept_ssl_errors;
 
