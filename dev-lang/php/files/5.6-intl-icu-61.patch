diff -uNr php-5.6.36-ori/acinclude.m4 php-5.6.36/acinclude.m4
--- php-5.6.36-ori/acinclude.m4	2018-04-25 06:22:50.000000000 +0800
+++ php-5.6.36/acinclude.m4	2018-07-06 13:44:47.251372321 +0800
@@ -2244,6 +2244,9 @@
     ICU_LIBS=`$ICU_CONFIG --ldflags --ldflags-icuio`
     PHP_EVAL_INCLINE($ICU_INCS)
     PHP_EVAL_LIBLINE($ICU_LIBS, $1)
+    
+    ICU_EXTRA_FLAGS=`$ICU_CONFIG --cxxflags`
+    ICU_EXTRA_FLAGS="$ICU_EXTRA_FLAGS -DU_USING_ICU_NAMESPACE=1"
   fi
 ])
 
diff -uNr php-5.6.36-ori/ext/intl/config.m4 php-5.6.36/ext/intl/config.m4
--- php-5.6.36-ori/ext/intl/config.m4	2018-04-25 06:22:50.000000000 +0800
+++ php-5.6.36/ext/intl/config.m4	2018-07-06 13:45:56.516691456 +0800
@@ -85,7 +85,7 @@
     breakiterator/codepointiterator_internal.cpp \
     breakiterator/codepointiterator_methods.cpp \
     idn/idn.c \
-    $icu_spoof_src, $ext_shared,,$ICU_INCS -Wno-write-strings)
+    $icu_spoof_src, $ext_shared,,$ICU_INCS -Wno-write-strings $ICU_EXTRA_FLAGS,cxx)
   PHP_ADD_BUILD_DIR($ext_builddir/collator)
   PHP_ADD_BUILD_DIR($ext_builddir/converter)
   PHP_ADD_BUILD_DIR($ext_builddir/common)
diff -uNr php-5.6.36-ori/ext/intl/config.w32 php-5.6.36/ext/intl/config.w32
--- php-5.6.36-ori/ext/intl/config.w32	2018-04-25 06:22:50.000000000 +0800
+++ php-5.6.36/ext/intl/config.w32	2018-07-06 13:46:37.957480548 +0800
@@ -118,7 +118,7 @@
 				"intl");
 		
 		ADD_FLAG("LIBS_INTL", "icudt.lib icuin.lib icuio.lib icule.lib iculx.lib");
-		ADD_FLAG("CFLAGS_INTL", "/EHsc");
+		ADD_FLAG("CFLAGS_INTL", "/EHsc /D U_USING_ICU_NAMESPACE=1");
 		AC_DEFINE("HAVE_INTL", 1, "Internationalization support enabled");
 	} else {
 		WARNING("intl not enabled; libraries and/or headers not found");
