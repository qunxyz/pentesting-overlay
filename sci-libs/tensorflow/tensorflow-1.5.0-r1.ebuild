# Copyright 1999-2016 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Id$

EAPI=5

PYTHON_COMPAT=( python{2_7,3_{4,5,6}} )

inherit pip-r1

PY_PV="${PV}${PR//r/rc}"

DESCRIPTION="Computation using data flow graphs for scalable machine learning"
HOMEPAGE="http://www.tensorflow.org"
pip-r1_init_pkg_fetch

LICENSE="GPLv2"
SLOT="0"
KEYWORDS="~x86 ~amd64"
IUSE="mkl jemalloc gcloud hdfs as3fs xla-jit gdr verbs opencl cuda mpi"

RDEPEND=">=dev-python/absl-py-0.1.6
	>=dev-python/enum34-1.1.6
	>=dev-python/mock-2.0.0
	>=dev-python/numpy-1.12.1
	>=dev-python/protobuf-python-3.4.0
	>=dev-python/six-1.10.0
	>=dev-python/backports-weakref-1.0-r1
	>=sci-libs/scipy-0.15.1

	sci-libs/tensorflow-tensorboard
"

DEPEND="${RDEPEND}
	opencl? ( sci-libs/computecpp-ce )
"

src_install() {
	pip-r1_src_install
	find ${D} -type f -name "tensorboard" | xargs rm
}
